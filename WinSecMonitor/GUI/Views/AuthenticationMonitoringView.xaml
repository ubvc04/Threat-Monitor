<UserControl x:Class="WinSecMonitor.GUI.Views.AuthenticationMonitoringView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:WinSecMonitor.GUI.Views"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800">
    
    <UserControl.Resources>
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="0,10,0,5"/>
        </Style>
        
        <Style x:Key="AlertHighlightStyle" TargetType="ListViewItem">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Severity}" Value="Low">
                    <Setter Property="Background" Value="#E6F7FF"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Severity}" Value="Medium">
                    <Setter Property="Background" Value="#FFF7E6"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Severity}" Value="High">
                    <Setter Property="Background" Value="#FFEBEB"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Severity}" Value="Critical">
                    <Setter Property="Background" Value="#FFD6D6"/>
                    <Setter Property="FontWeight" Value="Bold"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>
    
    <Grid>
        <TabControl>
            <!-- Authentication Events Tab -->
            <TabItem Header="Authentication Events">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Filter:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox x:Name="EventTypeFilter" Width="150" Margin="0,0,10,0" SelectionChanged="EventTypeFilter_SelectionChanged">
                            <ComboBoxItem Content="All Events" IsSelected="True"/>
                            <ComboBoxItem Content="Successful Logons"/>
                            <ComboBoxItem Content="Logoffs"/>
                            <ComboBoxItem Content="Failed Logons"/>
                            <ComboBoxItem Content="Account Lockouts"/>
                        </ComboBox>
                        
                        <TextBlock Text="Search:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                        <TextBox x:Name="AuthEventSearchBox" Width="200" TextChanged="AuthEventSearchBox_TextChanged"/>
                        
                        <Button x:Name="RefreshAuthEventsButton" Content="Refresh" Margin="10,0,0,0" Padding="10,3" Click="RefreshAuthEventsButton_Click"/>
                    </StackPanel>
                    
                    <ListView x:Name="AuthEventsListView" Grid.Row="1" ItemsSource="{Binding AuthenticationEvents}">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Time" Width="150" DisplayMemberBinding="{Binding FormattedTimestamp}"/>
                                <GridViewColumn Header="Event Type" Width="120" DisplayMemberBinding="{Binding EventType}"/>
                                <GridViewColumn Header="Username" Width="120" DisplayMemberBinding="{Binding Username}"/>
                                <GridViewColumn Header="Domain" Width="100" DisplayMemberBinding="{Binding Domain}"/>
                                <GridViewColumn Header="Workstation" Width="120" DisplayMemberBinding="{Binding WorkstationName}"/>
                                <GridViewColumn Header="IP Address" Width="120" DisplayMemberBinding="{Binding IpAddress}"/>
                                <GridViewColumn Header="Logon Type" Width="100" DisplayMemberBinding="{Binding LogonType}"/>
                                <GridViewColumn Header="Status" Width="150" DisplayMemberBinding="{Binding Status}"/>
                            </GridView>
                        </ListView.View>
                    </ListView>
                    
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <TextBlock x:Name="AuthEventsCountText" Text="Total Events: 0" VerticalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            
            <!-- RDP Sessions Tab -->
            <TabItem Header="RDP Sessions">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Filter:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox x:Name="RDPSessionFilter" Width="150" Margin="0,0,10,0" SelectionChanged="RDPSessionFilter_SelectionChanged">
                            <ComboBoxItem Content="All Sessions" IsSelected="True"/>
                            <ComboBoxItem Content="Active Sessions"/>
                            <ComboBoxItem Content="Disconnected Sessions"/>
                            <ComboBoxItem Content="Historical Sessions"/>
                        </ComboBox>
                        
                        <TextBlock Text="Search:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                        <TextBox x:Name="RDPSessionSearchBox" Width="200" TextChanged="RDPSessionSearchBox_TextChanged"/>
                        
                        <Button x:Name="RefreshRDPSessionsButton" Content="Refresh" Margin="10,0,0,0" Padding="10,3" Click="RefreshRDPSessionsButton_Click"/>
                    </StackPanel>
                    
                    <ListView x:Name="RDPSessionsListView" Grid.Row="1" ItemsSource="{Binding RDPSessions}">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Username" Width="120" DisplayMemberBinding="{Binding Username}"/>
                                <GridViewColumn Header="Session ID" Width="80" DisplayMemberBinding="{Binding SessionId}"/>
                                <GridViewColumn Header="State" Width="100" DisplayMemberBinding="{Binding SessionState}"/>
                                <GridViewColumn Header="Client Name" Width="120" DisplayMemberBinding="{Binding ClientName}"/>
                                <GridViewColumn Header="Client Address" Width="120" DisplayMemberBinding="{Binding ClientAddress}"/>
                                <GridViewColumn Header="Connect Time" Width="150" DisplayMemberBinding="{Binding FormattedConnectTime}"/>
                                <GridViewColumn Header="Disconnect Time" Width="150" DisplayMemberBinding="{Binding FormattedDisconnectTime}"/>
                                <GridViewColumn Header="Duration" Width="100" DisplayMemberBinding="{Binding FormattedDuration}"/>
                            </GridView>
                        </ListView.View>
                    </ListView>
                    
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <TextBlock x:Name="RDPSessionsCountText" Text="Total Sessions: 0" VerticalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            
            <!-- Privilege Events Tab -->
            <TabItem Header="Privilege Events">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Filter:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox x:Name="PrivilegeEventFilter" Width="150" Margin="0,0,10,0" SelectionChanged="PrivilegeEventFilter_SelectionChanged">
                            <ComboBoxItem Content="All Events" IsSelected="True"/>
                            <ComboBoxItem Content="Privilege Use"/>
                            <ComboBoxItem Content="Group Changes"/>
                            <ComboBoxItem Content="User Account Changes"/>
                            <ComboBoxItem Content="Process Elevation"/>
                        </ComboBox>
                        
                        <TextBlock Text="Search:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                        <TextBox x:Name="PrivilegeEventSearchBox" Width="200" TextChanged="PrivilegeEventSearchBox_TextChanged"/>
                        
                        <Button x:Name="RefreshPrivilegeEventsButton" Content="Refresh" Margin="10,0,0,0" Padding="10,3" Click="RefreshPrivilegeEventsButton_Click"/>
                    </StackPanel>
                    
                    <ListView x:Name="PrivilegeEventsListView" Grid.Row="1" ItemsSource="{Binding PrivilegeEvents}">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Time" Width="150" DisplayMemberBinding="{Binding FormattedTimestamp}"/>
                                <GridViewColumn Header="Event Type" Width="120" DisplayMemberBinding="{Binding EventType}"/>
                                <GridViewColumn Header="Username" Width="120" DisplayMemberBinding="{Binding Username}"/>
                                <GridViewColumn Header="Domain" Width="100" DisplayMemberBinding="{Binding Domain}"/>
                                <GridViewColumn Header="Process" Width="120" DisplayMemberBinding="{Binding ProcessName}"/>
                                <GridViewColumn Header="Privilege/Group" Width="150" DisplayMemberBinding="{Binding PrivilegeOrGroupName}"/>
                                <GridViewColumn Header="Action" Width="100" DisplayMemberBinding="{Binding Action}"/>
                                <GridViewColumn Header="Status" Width="100" DisplayMemberBinding="{Binding Status}"/>
                            </GridView>
                        </ListView.View>
                    </ListView>
                    
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <TextBlock x:Name="PrivilegeEventsCountText" Text="Total Events: 0" VerticalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            
            <!-- Security Alerts Tab -->
            <TabItem Header="Security Alerts">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Filter:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox x:Name="AlertTypeFilter" Width="150" Margin="0,0,10,0" SelectionChanged="AlertTypeFilter_SelectionChanged">
                            <ComboBoxItem Content="All Alerts" IsSelected="True"/>
                            <ComboBoxItem Content="Authentication Alerts"/>
                            <ComboBoxItem Content="RDP Alerts"/>
                            <ComboBoxItem Content="Privilege Alerts"/>
                        </ComboBox>
                        
                        <ComboBox x:Name="AlertSeverityFilter" Width="150" Margin="0,0,10,0" SelectionChanged="AlertSeverityFilter_SelectionChanged">
                            <ComboBoxItem Content="All Severities" IsSelected="True"/>
                            <ComboBoxItem Content="Low"/>
                            <ComboBoxItem Content="Medium"/>
                            <ComboBoxItem Content="High"/>
                            <ComboBoxItem Content="Critical"/>
                        </ComboBox>
                        
                        <TextBlock Text="Search:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                        <TextBox x:Name="AlertSearchBox" Width="200" TextChanged="AlertSearchBox_TextChanged"/>
                    </StackPanel>
                    
                    <ListView x:Name="AlertsListView" Grid.Row="1" ItemsSource="{Binding ActiveAlerts}" ItemContainerStyle="{StaticResource AlertHighlightStyle}" SelectionChanged="AlertsListView_SelectionChanged">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Time" Width="150" DisplayMemberBinding="{Binding FormattedTimestamp}"/>
                                <GridViewColumn Header="Type" Width="100" DisplayMemberBinding="{Binding AlertType}"/>
                                <GridViewColumn Header="Source" Width="150" DisplayMemberBinding="{Binding Source}"/>
                                <GridViewColumn Header="Username" Width="120" DisplayMemberBinding="{Binding Username}"/>
                                <GridViewColumn Header="Severity" Width="80" DisplayMemberBinding="{Binding FormattedSeverity}"/>
                                <GridViewColumn Header="Description" Width="250" DisplayMemberBinding="{Binding Description}"/>
                                <GridViewColumn Header="Status" Width="150" DisplayMemberBinding="{Binding Status}"/>
                            </GridView>
                        </ListView.View>
                    </ListView>
                    
                    <TextBox x:Name="AlertDetailsTextBox" Grid.Row="2" Height="100" Margin="0,10,0,0" IsReadOnly="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"/>
                    
                    <StackPanel Grid.Row="3" Orientation="Horizontal" Margin="0,10,0,0">
                        <Button x:Name="AcknowledgeAlertButton" Content="Acknowledge Selected" Width="150" Margin="0,0,10,0" Click="AcknowledgeAlertButton_Click" IsEnabled="False"/>
                        <Button x:Name="AcknowledgeAllAlertsButton" Content="Acknowledge All" Width="150" Margin="0,0,10,0" Click="AcknowledgeAllAlertsButton_Click"/>
                        <Button x:Name="ViewAlertHistoryButton" Content="View Alert History" Width="150" Margin="0,0,10,0" Click="ViewAlertHistoryButton_Click"/>
                        <TextBlock x:Name="AlertsCountText" Text="Active Alerts: 0" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            
            <!-- Alert History Tab -->
            <TabItem Header="Alert History">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Filter:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox x:Name="HistoryAlertTypeFilter" Width="150" Margin="0,0,10,0" SelectionChanged="HistoryAlertTypeFilter_SelectionChanged">
                            <ComboBoxItem Content="All Alerts" IsSelected="True"/>
                            <ComboBoxItem Content="Authentication Alerts"/>
                            <ComboBoxItem Content="RDP Alerts"/>
                            <ComboBoxItem Content="Privilege Alerts"/>
                        </ComboBox>
                        
                        <ComboBox x:Name="HistoryAlertSeverityFilter" Width="150" Margin="0,0,10,0" SelectionChanged="HistoryAlertSeverityFilter_SelectionChanged">
                            <ComboBoxItem Content="All Severities" IsSelected="True"/>
                            <ComboBoxItem Content="Low"/>
                            <ComboBoxItem Content="Medium"/>
                            <ComboBoxItem Content="High"/>
                            <ComboBoxItem Content="Critical"/>
                        </ComboBox>
                        
                        <TextBlock Text="Search:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                        <TextBox x:Name="HistoryAlertSearchBox" Width="200" TextChanged="HistoryAlertSearchBox_TextChanged"/>
                    </StackPanel>
                    
                    <ListView x:Name="AlertHistoryListView" Grid.Row="1" ItemsSource="{Binding AlertHistory}" ItemContainerStyle="{StaticResource AlertHighlightStyle}" SelectionChanged="AlertHistoryListView_SelectionChanged">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Time" Width="150" DisplayMemberBinding="{Binding FormattedTimestamp}"/>
                                <GridViewColumn Header="Type" Width="100" DisplayMemberBinding="{Binding AlertType}"/>
                                <GridViewColumn Header="Source" Width="150" DisplayMemberBinding="{Binding Source}"/>
                                <GridViewColumn Header="Username" Width="120" DisplayMemberBinding="{Binding Username}"/>
                                <GridViewColumn Header="Severity" Width="80" DisplayMemberBinding="{Binding FormattedSeverity}"/>
                                <GridViewColumn Header="Description" Width="250" DisplayMemberBinding="{Binding Description}"/>
                                <GridViewColumn Header="Status" Width="150" DisplayMemberBinding="{Binding Status}"/>
                            </GridView>
                        </ListView.View>
                    </ListView>
                    
                    <TextBox x:Name="HistoryAlertDetailsTextBox" Grid.Row="2" Height="100" Margin="0,10,0,0" IsReadOnly="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"/>
                    
                    <StackPanel Grid.Row="3" Orientation="Horizontal" Margin="0,10,0,0">
                        <Button x:Name="ExportAlertHistoryButton" Content="Export History" Width="150" Margin="0,0,10,0" Click="ExportAlertHistoryButton_Click"/>
                        <Button x:Name="ClearAlertHistoryButton" Content="Clear History" Width="150" Margin="0,0,10,0" Click="ClearAlertHistoryButton_Click"/>
                        <TextBlock x:Name="AlertHistoryCountText" Text="Total Alerts: 0" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</UserControl>